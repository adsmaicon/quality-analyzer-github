[{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5233","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5233/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5233/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5233/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/5233","id":1187854942,"node_id":"I_kwDOAAfumM5GzTpe","number":5233,"title":"Drop Support For Python 3.8 and 3.9","user":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","site_admin":false},"labels":[{"id":472787987,"node_id":"MDU6TGFiZWw0NzI3ODc5ODc=","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/RFC","name":"RFC","color":"b60205","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-03-31T10:18:12Z","updated_at":"2022-03-31T10:18:12Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"TL;DR: Does anyone have objections against dropping support for older Python versions?\r\n\r\nWe don't have too many reasons to support a wide range of versions, and it would be nice to make use of the new 3.10 type annotations when cleaning up some option handling. With the upcoming release of Ubuntu 22.04, there will also be an Ubuntu LTS release that ships Python 3.10 out of the box. It's not a move we need to make urgently, but I figured I'd open this issue already now to give folks the opportunity to voice their concerns (if any).","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5233/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5233/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5232","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5232/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5232/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5232/events","html_url":"https://github.com/mitmproxy/mitmproxy/pull/5232","id":1187413944,"node_id":"PR_kwDOAAfumM41XSjg","number":5232,"title":"Add DNS support.","user":{"login":"Meitinger","id":3720329,"node_id":"MDQ6VXNlcjM3MjAzMjk=","avatar_url":"https://avatars.githubusercontent.com/u/3720329?v=4","gravatar_id":"","url":"https://api.github.com/users/Meitinger","html_url":"https://github.com/Meitinger","followers_url":"https://api.github.com/users/Meitinger/followers","following_url":"https://api.github.com/users/Meitinger/following{/other_user}","gists_url":"https://api.github.com/users/Meitinger/gists{/gist_id}","starred_url":"https://api.github.com/users/Meitinger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Meitinger/subscriptions","organizations_url":"https://api.github.com/users/Meitinger/orgs","repos_url":"https://api.github.com/users/Meitinger/repos","events_url":"https://api.github.com/users/Meitinger/events{/privacy}","received_events_url":"https://api.github.com/users/Meitinger/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-03-31T02:35:17Z","updated_at":"2022-03-31T20:25:02Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"draft":true,"pull_request":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/pulls/5232","html_url":"https://github.com/mitmproxy/mitmproxy/pull/5232","diff_url":"https://github.com/mitmproxy/mitmproxy/pull/5232.diff","patch_url":"https://github.com/mitmproxy/mitmproxy/pull/5232.patch","merged_at":null},"body":"#### Description\r\n\r\n- implemented UDP layer that mimics `asyncio.start_server` and `asyncio.open_connection`\r\n- introduced `DNSFlow` and `DNSLayer`, together with console and web representation\r\n- extended filtering, saving and tests to DNS\r\n- full coverage for `DNSLayer`\r\n- DNS server addon, UDP and `DNSLayer` not yet fully covered\r\n- changed `lightred` to `red` for failed flows in web UI and made method sort consistent with what the user sees (regarding WS and WSS)\r\n\r\n#### Checklist\r\n\r\n - [x] I have updated tests where applicable.\r\n - [x] I have added an entry to the CHANGELOG.\r\n","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5232/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5232/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5231","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5231/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5231/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5231/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/5231","id":1186415398,"node_id":"I_kwDOAAfumM5Gt0Mm","number":5231,"title":"Console: Make it easier to edit binary contents","user":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","site_admin":false},"labels":[{"id":79336545,"node_id":"MDU6TGFiZWw3OTMzNjU0NQ==","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/kind/feature","name":"kind/feature","color":"207de5","default":false,"description":"New features / enhancements"},{"id":174959532,"node_id":"MDU6TGFiZWwxNzQ5NTk1MzI=","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/help%20wanted","name":"help wanted","color":"fbca04","default":true,"description":null},{"id":943316112,"node_id":"MDU6TGFiZWw5NDMzMTYxMTI=","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/kind/ux","name":"kind/ux","color":"0e8a16","default":false,"description":"User experience improvements"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-03-30T12:52:10Z","updated_at":"2022-03-30T12:52:10Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"#### Problem Description\r\n\r\nRight now, editing a request or response body opens the default text editor. \r\nThis is a bad choice for binary formats, which should much rather be opened in a hex editor.\r\n\r\n#### Steps to reproduce the behavior:\r\n1. Make an HTTP request to a binary file, e.g. `https://www.google.com/favicon.ico`\r\n2. Edit the response body in mitmproxy.\r\n\r\n#### Proposed Fix\r\n\r\n1. Assemble a list of console-based hex editors and order them by usefulness.\r\n2. Adjust [`ConsoleMaster.spawn_editor`](https://github.com/mitmproxy/mitmproxy/blob/0fa7c463683149a0b400108420efc09ff72f11a5/mitmproxy/tools/console/master.py#L112-L145) to  detect binary contents and then spawn a hex editor instead.\r\n\r\n\r\nWe already have a function to detect if contents are binary in [`mitmproxy.utils.strutils`](https://github.com/mitmproxy/mitmproxy/blob/0fa7c463683149a0b400108420efc09ff72f11a5/mitmproxy/utils/strutils.py#L125).\r\n\r\n","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5231/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5231/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5227","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5227/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5227/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5227/events","html_url":"https://github.com/mitmproxy/mitmproxy/pull/5227","id":1184921161,"node_id":"PR_kwDOAAfumM41O6V-","number":5227,"title":"Add `Flow.timestamp_created` to retain list order on replay","user":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2022-03-29T14:00:52Z","updated_at":"2022-03-29T18:07:00Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/pulls/5227","html_url":"https://github.com/mitmproxy/mitmproxy/pull/5227","diff_url":"https://github.com/mitmproxy/mitmproxy/pull/5227.diff","patch_url":"https://github.com/mitmproxy/mitmproxy/pull/5227.patch","merged_at":null},"body":"This PR adds `Flow.timestamp_created`, which is used to make sure that replayed flows retain their position in the flow list. They don't jump to the bottom of the list anymore.\r\n\r\n@Prinzhorn / @Kriechi, given that this is a public API change, any comments?","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5227/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5227/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5219","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5219/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5219/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5219/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/5219","id":1183441542,"node_id":"I_kwDOAAfumM5GieKG","number":5219,"title":"iOS 15.4 - kCFErrorDomainCFNetwork Code=310","user":{"login":"knlr","id":1219683,"node_id":"MDQ6VXNlcjEyMTk2ODM=","avatar_url":"https://avatars.githubusercontent.com/u/1219683?v=4","gravatar_id":"","url":"https://api.github.com/users/knlr","html_url":"https://github.com/knlr","followers_url":"https://api.github.com/users/knlr/followers","following_url":"https://api.github.com/users/knlr/following{/other_user}","gists_url":"https://api.github.com/users/knlr/gists{/gist_id}","starred_url":"https://api.github.com/users/knlr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/knlr/subscriptions","organizations_url":"https://api.github.com/users/knlr/orgs","repos_url":"https://api.github.com/users/knlr/repos","events_url":"https://api.github.com/users/knlr/events{/privacy}","received_events_url":"https://api.github.com/users/knlr/received_events","type":"User","site_admin":false},"labels":[{"id":466930397,"node_id":"MDU6TGFiZWw0NjY5MzAzOTc=","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/kind/triage","name":"kind/triage","color":"006b75","default":false,"description":"Unclassified issues"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2022-03-28T13:26:14Z","updated_at":"2022-03-29T06:49:08Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"#### Problem Description\r\nHTTPS is no longer working on iOS 15.4 - it seems iOS (CFNetworking?) is not accepting the certificate.\r\n\r\n#### Steps to reproduce the behavior:\r\n1. In Xcode 13.4, create a new simulator with iOS 15.4\r\n2. Set machine up to proxy through mitmproxy\r\n3. In simulator Safari, go to mitm.it and install certificate.\r\n4. [Configure URLSession to use proxy ](https://stackoverflow.com/a/28101583/2378197)\r\n5. Try to make https call in app\r\n\r\nResult:\r\nHTTPS calls will fail with this error:\r\n<URL> Error Domain=kCFErrorDomainCFNetwork Code=310 \"(null)\" UserInfo={_NSURLErrorFailingURLSessionTaskErrorKey=LocalDataTask <task id>.<1>, _kCFStreamErrorDomainKey=4, _kCFStreamErrorCodeKey=-2096, _NSURLErrorRelatedURLSessionTaskErrorKey=(\r\n    \"LocalDataTask <task id>.<1>\"\r\n), _NSURLErrorNWPathKey=satisfied (Path is satisfied), interface: en0}\r\n\r\nNotes:\r\n- It does work when proxying the host machine and not explicitly configuring the URL session\r\n- it also seems to work with simulators that have had their certificate installed before upgrading to Xcode 13.4\r\n\r\n#### System Information\r\nMitmproxy: 7.0.4\r\nPython:    3.9.9\r\nOpenSSL:   OpenSSL 1.1.1l  24 Aug 2021\r\nPlatform:  macOS-12.2.1-x86_64-i386-64bit\r\n","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5219/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5219/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5209","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5209/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5209/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5209/events","html_url":"https://github.com/mitmproxy/mitmproxy/pull/5209","id":1180946826,"node_id":"PR_kwDOAAfumM41Bo0I","number":5209,"title":"Update overview-getting-started.md","user":{"login":"stepanBoichyshyn","id":84029657,"node_id":"MDQ6VXNlcjg0MDI5NjU3","avatar_url":"https://avatars.githubusercontent.com/u/84029657?v=4","gravatar_id":"","url":"https://api.github.com/users/stepanBoichyshyn","html_url":"https://github.com/stepanBoichyshyn","followers_url":"https://api.github.com/users/stepanBoichyshyn/followers","following_url":"https://api.github.com/users/stepanBoichyshyn/following{/other_user}","gists_url":"https://api.github.com/users/stepanBoichyshyn/gists{/gist_id}","starred_url":"https://api.github.com/users/stepanBoichyshyn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stepanBoichyshyn/subscriptions","organizations_url":"https://api.github.com/users/stepanBoichyshyn/orgs","repos_url":"https://api.github.com/users/stepanBoichyshyn/repos","events_url":"https://api.github.com/users/stepanBoichyshyn/events{/privacy}","received_events_url":"https://api.github.com/users/stepanBoichyshyn/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-03-25T15:39:34Z","updated_at":"2022-03-25T15:40:24Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/pulls/5209","html_url":"https://github.com/mitmproxy/mitmproxy/pull/5209","diff_url":"https://github.com/mitmproxy/mitmproxy/pull/5209.diff","patch_url":"https://github.com/mitmproxy/mitmproxy/pull/5209.patch","merged_at":null},"body":"#### Description\r\n\r\nCurrent doc has 0 examples of the basic use-cases. I spent too much time reading everything before realized what **commands** are what **options** are and how to set up simple `reverse proxy` for my needs.\r\n\r\n#### Checklist\r\n\r\n ~- [ ] I have updated tests where applicable.~\r\n ~- [ ] I have added an entry to the CHANGELOG.~\r\n","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5209/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5209/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5208","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5208/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5208/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5208/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/5208","id":1180367418,"node_id":"I_kwDOAAfumM5GWvo6","number":5208,"title":"Does mitmproxy support bandwidth throttling?","user":{"login":"PankajKaushik78","id":22210915,"node_id":"MDQ6VXNlcjIyMjEwOTE1","avatar_url":"https://avatars.githubusercontent.com/u/22210915?v=4","gravatar_id":"","url":"https://api.github.com/users/PankajKaushik78","html_url":"https://github.com/PankajKaushik78","followers_url":"https://api.github.com/users/PankajKaushik78/followers","following_url":"https://api.github.com/users/PankajKaushik78/following{/other_user}","gists_url":"https://api.github.com/users/PankajKaushik78/gists{/gist_id}","starred_url":"https://api.github.com/users/PankajKaushik78/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PankajKaushik78/subscriptions","organizations_url":"https://api.github.com/users/PankajKaushik78/orgs","repos_url":"https://api.github.com/users/PankajKaushik78/repos","events_url":"https://api.github.com/users/PankajKaushik78/events{/privacy}","received_events_url":"https://api.github.com/users/PankajKaushik78/received_events","type":"User","site_admin":false},"labels":[{"id":79336545,"node_id":"MDU6TGFiZWw3OTMzNjU0NQ==","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/kind/feature","name":"kind/feature","color":"207de5","default":false,"description":"New features / enhancements"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2022-03-25T05:37:24Z","updated_at":"2022-03-30T10:50:35Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Hey, is there any way we can do bandwidth throttling to simulate the slow internet connections (2G, 3G, 4G)?\r\n","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5208/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5208/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5198","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5198/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5198/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5198/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/5198","id":1174889566,"node_id":"I_kwDOAAfumM5GB2Re","number":5198,"title":"[mitmweb] mitmproxy has crashed when scroll down the page","user":{"login":"sanlengjingvv","id":6478615,"node_id":"MDQ6VXNlcjY0Nzg2MTU=","avatar_url":"https://avatars.githubusercontent.com/u/6478615?v=4","gravatar_id":"","url":"https://api.github.com/users/sanlengjingvv","html_url":"https://github.com/sanlengjingvv","followers_url":"https://api.github.com/users/sanlengjingvv/followers","following_url":"https://api.github.com/users/sanlengjingvv/following{/other_user}","gists_url":"https://api.github.com/users/sanlengjingvv/gists{/gist_id}","starred_url":"https://api.github.com/users/sanlengjingvv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sanlengjingvv/subscriptions","organizations_url":"https://api.github.com/users/sanlengjingvv/orgs","repos_url":"https://api.github.com/users/sanlengjingvv/repos","events_url":"https://api.github.com/users/sanlengjingvv/events{/privacy}","received_events_url":"https://api.github.com/users/sanlengjingvv/received_events","type":"User","site_admin":false},"labels":[{"id":466930397,"node_id":"MDU6TGFiZWw0NjY5MzAzOTc=","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/kind/triage","name":"kind/triage","color":"006b75","default":false,"description":"Unclassified issues"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-03-21T04:56:31Z","updated_at":"2022-03-21T04:56:31Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"#### Problem Description\r\nMay be related to websocket.\r\n\r\nError message show on page\r\n```\r\nError: Maximum update depth exceeded. This can happen when a component repeatedly calls setState inside componentWillUpdate or componentDidUpdate. React limits the number of nested updates to prevent infinite loops.\r\n    at checkForNestedUpdates (http://127.0.0.1:8081/static/app.js:19477:25)\r\n    at scheduleUpdateOnFiber (http://127.0.0.1:8081/static/app.js:18176:13)\r\n    at Object.enqueueSetState (http://127.0.0.1:8081/static/app.js:11577:15)\r\n    at _a.Component14.setState (http://127.0.0.1:8081/static/app.js:349:26)\r\n    at _a.onViewportUpdate (http://127.0.0.1:8081/static/app.js:48134:14)\r\n    at _a.componentDidUpdate (http://127.0.0.1:8081/static/app.js:48100:12)\r\n    at _a.componentDidUpdate (http://127.0.0.1:8081/static/app.js:48002:43)\r\n    at commitLifeCycles (http://127.0.0.1:8081/static/app.js:17400:32)\r\n    at commitLayoutEffects (http://127.0.0.1:8081/static/app.js:19200:17)\r\n    at HTMLUnknownElement.callCallback (http://127.0.0.1:8081/static/app.js:5588:24)\r\n\r\nComponent Stack:\r\n    at AutoScrollWrapper (http://127.0.0.1:8081/static/app.js:47990:55)\r\n    at ConnectFunction (http://127.0.0.1:8081/static/app.js:40488:50)\r\n    at div\r\n    at MainView (http://127.0.0.1:8081/static/app.js:48178:26)\r\n    at div\r\n    at ProxyAppMain (http://127.0.0.1:8081/static/app.js:50253:7)\r\n    at ConnectFunction (http://127.0.0.1:8081/static/app.js:40488:50)\r\n    at Provider (http://127.0.0.1:8081/static/app.js:40280:23)\r\n```\r\n\r\nError message show on chrome dev tools console\r\n```\r\nreact-dom.development.js:23803 Uncaught Error: Maximum update depth exceeded. This can happen when a component repeatedly calls setState inside componentWillUpdate or componentDidUpdate. React limits the number of nested updates to prevent infinite loops.\r\n    at checkForNestedUpdates (react-dom.development.js:23803:15)\r\n    at scheduleUpdateOnFiber (react-dom.development.js:21835:3)\r\n    at Object.enqueueSetState (react-dom.development.js:12467:5)\r\n    at _a.Component14.setState (react.development.js:365:16)\r\n    at _a.onViewportUpdate (FlowTable.jsx:88:18)\r\n    at _a.componentDidUpdate (FlowTable.jsx:42:14)\r\n    at _a.componentDidUpdate (AutoScroll.tsx:23:43)\r\n    at commitLifeCycles (react-dom.development.js:20684:24)\r\n    at commitLayoutEffects (react-dom.development.js:23426:7)\r\n    at HTMLUnknownElement.callCallback (react-dom.development.js:3945:14)\r\n\r\nreact-dom.development.js:20085 The above error occurred in the <FlowTable> component:\r\n\r\n    at AutoScrollWrapper (http://127.0.0.1:8081/static/app.js:47990:55)\r\n    at ConnectFunction (http://127.0.0.1:8081/static/app.js:40488:50)\r\n    at div\r\n    at MainView (http://127.0.0.1:8081/static/app.js:48178:26)\r\n    at div\r\n    at ProxyAppMain (http://127.0.0.1:8081/static/app.js:50253:7)\r\n    at ConnectFunction (http://127.0.0.1:8081/static/app.js:40488:50)\r\n    at Provider (http://127.0.0.1:8081/static/app.js:40280:23)\r\n\r\nReact will try to recreate this component tree from scratch using the error boundary you provided, ProxyAppMain.\r\n\r\nreact-dom.development.js:4452 Uncaught Error: Unable to find node on an unmounted component.\r\n    at findCurrentFiberUsingSlowPath (react-dom.development.js:4452:13)\r\n    at findCurrentHostFiber (react-dom.development.js:4465:23)\r\n    at findHostInstanceWithWarning (react-dom.development.js:25389:21)\r\n    at Object.findDOMNode (react-dom.development.js:26067:12)\r\n    at _a.onViewportUpdate (FlowTable.jsx:77:35)\r\n```\r\n\r\n#### Steps to reproduce the behavior:\r\n1. Start mitmweb \r\n2. Proxy an app with websocket\r\n3. Wait a while and scroll down the mitmweb page\r\n\r\n#### System Information\r\n> Mitmproxy: 9.0.0.dev (+274, commit 01d6795)\r\nPython:    3.8.10\r\nOpenSSL:   OpenSSL 1.1.1m  14 Dec 2021\r\nPlatform:  macOS-10.16-x86_64-i386-64bit\r\n","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5198/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5198/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5167","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5167/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5167/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5167/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/5167","id":1164144507,"node_id":"I_kwDOAAfumM5FY297","number":5167,"title":"showhost should default to true","user":{"login":"89z","id":73562167,"node_id":"MDQ6VXNlcjczNTYyMTY3","avatar_url":"https://avatars.githubusercontent.com/u/73562167?v=4","gravatar_id":"","url":"https://api.github.com/users/89z","html_url":"https://github.com/89z","followers_url":"https://api.github.com/users/89z/followers","following_url":"https://api.github.com/users/89z/following{/other_user}","gists_url":"https://api.github.com/users/89z/gists{/gist_id}","starred_url":"https://api.github.com/users/89z/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/89z/subscriptions","organizations_url":"https://api.github.com/users/89z/orgs","repos_url":"https://api.github.com/users/89z/repos","events_url":"https://api.github.com/users/89z/events{/privacy}","received_events_url":"https://api.github.com/users/89z/received_events","type":"User","site_admin":false},"labels":[{"id":429899749,"node_id":"MDU6TGFiZWw0Mjk4OTk3NDk=","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/area/core","name":"area/core","color":"fef2c0","default":false,"description":null},{"id":943316112,"node_id":"MDU6TGFiZWw5NDMzMTYxMTI=","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/kind/ux","name":"kind/ux","color":"0e8a16","default":false,"description":"User experience improvements"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-03-09T16:10:47Z","updated_at":"2022-03-16T15:27:11Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"#### Problem Description\r\n\r\nCurrently the output of MITM Proxy gives the IP address for the host in all URLs. I think most people expect the proper host name to be used here. I understand that host can come from different sources (HTTP header, SNI), but I think picking one of those, is better than picking neither. Even if the result is wrong sometimes, users can always set `showhost` to false to get the IP again.\r\n\r\n\r\n#### System Information\r\n\r\n~~~\r\nMitmproxy: 7.0.4 binary\r\nPython:    3.9.7\r\nOpenSSL:   OpenSSL 1.1.1l  24 Aug 2021\r\nPlatform:  Windows-10-10.0.18363-SP0\r\n~~~\r\n\r\n","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5167/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5167/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5157","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5157/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5157/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5157/events","html_url":"https://github.com/mitmproxy/mitmproxy/pull/5157","id":1150816366,"node_id":"PR_kwDOAAfumM4ze-9f","number":5157,"title":"Add TLS config mirroring","user":{"login":"fedosgad","id":5519748,"node_id":"MDQ6VXNlcjU1MTk3NDg=","avatar_url":"https://avatars.githubusercontent.com/u/5519748?v=4","gravatar_id":"","url":"https://api.github.com/users/fedosgad","html_url":"https://github.com/fedosgad","followers_url":"https://api.github.com/users/fedosgad/followers","following_url":"https://api.github.com/users/fedosgad/following{/other_user}","gists_url":"https://api.github.com/users/fedosgad/gists{/gist_id}","starred_url":"https://api.github.com/users/fedosgad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fedosgad/subscriptions","organizations_url":"https://api.github.com/users/fedosgad/orgs","repos_url":"https://api.github.com/users/fedosgad/repos","events_url":"https://api.github.com/users/fedosgad/events{/privacy}","received_events_url":"https://api.github.com/users/fedosgad/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-02-25T20:00:50Z","updated_at":"2022-03-30T13:09:16Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"draft":true,"pull_request":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/pulls/5157","html_url":"https://github.com/mitmproxy/mitmproxy/pull/5157","diff_url":"https://github.com/mitmproxy/mitmproxy/pull/5157.diff","patch_url":"https://github.com/mitmproxy/mitmproxy/pull/5157.patch","merged_at":null},"body":"#### Description\r\n\r\nModify tlsconfig.py to mirror client's ciphersuites to server\r\n\r\n#### Checklist\r\n\r\n - [ ] I have updated tests where applicable.\r\n - [ ] I have added an entry to the CHANGELOG.\r\n","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5157/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5157/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5156","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5156/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5156/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5156/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/5156","id":1149785849,"node_id":"I_kwDOAAfumM5EiFb5","number":5156,"title":"--allow-hosts allowing more than specified single host","user":{"login":"Joshfindit","id":1937155,"node_id":"MDQ6VXNlcjE5MzcxNTU=","avatar_url":"https://avatars.githubusercontent.com/u/1937155?v=4","gravatar_id":"","url":"https://api.github.com/users/Joshfindit","html_url":"https://github.com/Joshfindit","followers_url":"https://api.github.com/users/Joshfindit/followers","following_url":"https://api.github.com/users/Joshfindit/following{/other_user}","gists_url":"https://api.github.com/users/Joshfindit/gists{/gist_id}","starred_url":"https://api.github.com/users/Joshfindit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Joshfindit/subscriptions","organizations_url":"https://api.github.com/users/Joshfindit/orgs","repos_url":"https://api.github.com/users/Joshfindit/repos","events_url":"https://api.github.com/users/Joshfindit/events{/privacy}","received_events_url":"https://api.github.com/users/Joshfindit/received_events","type":"User","site_admin":false},"labels":[{"id":109607759,"node_id":"MDU6TGFiZWwxMDk2MDc3NTk=","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/kind/docs","name":"kind/docs","color":"5319e7","default":false,"description":"Documentation work needs to be done!"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2022-02-24T21:52:23Z","updated_at":"2022-03-16T15:15:01Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"#### Problem Description\r\nWhile using `mitmproxy` to observe traffic to a single domain, the UI is cluttered with other traffic.\r\n\r\nThe actual command I'm running:\r\n`mitmproxy --ssl-insecure --allow-hosts 'discord.gift'`\r\n\r\nI'm then configuring a single iOS device to use the proxy.\r\n\r\nInstead of that single domain, I see traffic to non-SSL services on the LAN.\r\nI (now) understand that the subtext of `--allow-hosts` is \"allow traffic to these hosts to be decrypted/MITMd\", but that is not clear from the command. I feel like this is a bug because the documentation suggests that `--allow-hosts` allows us to focus only on traffic to the host(s) specified and it does not make any mention of HTTP vs HTTPS.\r\n\r\n\r\n\r\n#### Steps to reproduce the behavior:\r\n1. Run `mitmproxy` with `--allow-hosts 'example.com'`\r\n2. Pass HTTP traffic through `mitmproxy`\r\n3. View the requests inside `mitmproxy`\r\n\r\n#### System Information\r\nPaste the output of \"mitmproxy --version\" here.\r\n```\r\nMitmproxy: 7.0.4 binary\r\nPython:    3.9.7\r\nOpenSSL:   OpenSSL 1.1.1l  24 Aug 2021\r\nPlatform:  Linux-5.4.162-1-pve-x86_64-with-glibc2.27\r\n```","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5156/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5156/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5148","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5148/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5148/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5148/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/5148","id":1145210517,"node_id":"I_kwDOAAfumM5EQoaV","number":5148,"title":"Crash when editing multipart/formdata","user":{"login":"psacawa","id":21274063,"node_id":"MDQ6VXNlcjIxMjc0MDYz","avatar_url":"https://avatars.githubusercontent.com/u/21274063?v=4","gravatar_id":"","url":"https://api.github.com/users/psacawa","html_url":"https://github.com/psacawa","followers_url":"https://api.github.com/users/psacawa/followers","following_url":"https://api.github.com/users/psacawa/following{/other_user}","gists_url":"https://api.github.com/users/psacawa/gists{/gist_id}","starred_url":"https://api.github.com/users/psacawa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/psacawa/subscriptions","organizations_url":"https://api.github.com/users/psacawa/orgs","repos_url":"https://api.github.com/users/psacawa/repos","events_url":"https://api.github.com/users/psacawa/events{/privacy}","received_events_url":"https://api.github.com/users/psacawa/received_events","type":"User","site_admin":false},"labels":[{"id":466930397,"node_id":"MDU6TGFiZWw0NjY5MzAzOTc=","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/kind/triage","name":"kind/triage","color":"006b75","default":false,"description":"Unclassified issues"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-02-21T01:23:10Z","updated_at":"2022-02-21T02:23:26Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"#### Problem Description\r\n\r\nI received the following message when editng a field of a `multipart/form-data` request body, which is for for file uploads.\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"mitmproxy/master.py\", line 54, in run_loop\r\n  File \"urwid/main_loop.py\", line 287, in run\r\n  File \"urwid/main_loop.py\", line 385, in _run\r\n  File \"urwid/main_loop.py\", line 1494, in run\r\n  File \"urwid/compat.py\", line 58, in reraise\r\n  File \"asyncio/events.py\", line 80, in _run\r\n  File \"urwid/raw_display.py\", line 416, in <lambda>\r\n  File \"urwid/raw_display.py\", line 515, in parse_input\r\n  File \"urwid/main_loop.py\", line 412, in _update\r\n  File \"urwid/main_loop.py\", line 513, in process_input' (No such file or directory)\r\n  File \"mitmproxy/tools/console/window.py\", line 318, in keypress\r\n  File \"mitmproxy/tools/console/keymap.py\", line 145, in handle\r\n  File \"mitmproxy/tools/console/commandexecutor.py\", line 18, in __call__\r\n  File \"mitmproxy/command.py\", line 273, in execute\r\n  File \"mitmproxy/command.py\", line 259, in call_strings\r\n  File \"mitmproxy/command.py\", line 129, in call\r\n  File \"mitmproxy/command.py\", line 303, in wrapper\r\n  File \"mitmproxy/tools/console/consoleaddons.py\", line 328, in view_pop\r\n  File \"blinker/base.py\", line 266, in send\r\n  File \"blinker/base.py\", line 266, in <listcomp>\r\n  File \"mitmproxy/tools/console/window.py\", line 247, in pop\r\n  File \"mitmproxy/tools/console/window.py\", line 114, in pop\r\n  File \"mitmproxy/tools/console/window.py\", line 126, in call\r\n  File \"mitmproxy/tools/console/grideditor/base.py\", line 462, in layout_popping\r\n  File \"mitmproxy/tools/console/grideditor/base.py\", line 440, in call\r\n  File \"mitmproxy/tools/console/grideditor/base.py\", line 313, in layout_popping\r\n  File \"mitmproxy/tools/console/grideditor/base.py\", line 455, in set_data_update\r\n  File \"mitmproxy/tools/console/grideditor/editors.py\", line 68, in set_data\r\n  File \"mitmproxy/http.py\", line 998, in multipart_form\r\n  File \"mitmproxy/http.py\", line 979, in _set_multipart_form\r\n  File \"mitmproxy/net/http/multipart.py\", line 34, in encode\r\n  File \"re.py\", line 201, in search\r\nTypeError: cannot use a bytes pattern on a string-like object\r\n\r\nmitmproxy has crashed!\r\nPlease lodge a bug report at:\r\n        https://github.com/mitmproxy/mitmproxy/issues\r\n```\r\nRecording: \r\n[![asciicast](https://asciinema.org/a/CZuTvDKY3PPObhJCGfUx7vagA.svg)](https://asciinema.org/a/CZuTvDKY3PPObhJCGfUx7vagA)\r\nYou can see in the recording that the Grideditor fields display the stringified bytes objects `str(b'asdf')`. I have been able to recreate the bug editing all fields of the `multipart/form-data`, not just the one for the file itself. **This bug has nothing to do with the external editor, as I initially wrote.**\r\n\r\nAnother issue is the the GridEditor  for `multipart/form-data` is very slow for even medium-sized files. When dealing with a 197Kb file, it becomes unresponsive.\r\n\r\n#### Steps to reproduce the behavior:\r\n1. Send a post request with a file upload encoded as `multipart/form-data` \r\n2. Edit a field of the request with the `multipart/form-data`  `GridEditor` view directly in `mitmproxy`\r\n3. Return from the external editor by pressing `Q`.\r\n\r\n#### System Information\r\nReplicated on:\r\n```\r\nMitmproxy: 7.0.0 binary\r\nPython:    3.9.5\r\nOpenSSL:   OpenSSL 1.1.1k  25 Mar 2021\r\nPlatform:  Linux-5.13.0-28-generic-x86_64-with-glibc2.31\r\n```\r\n\r\n```\r\nMitmproxy: 7.0.4 binary\r\nPython:    3.9.7\r\nOpenSSL:   OpenSSL 1.1.1l  24 Aug 2021\r\nPlatform:  Linux-5.13.0-28-generic-x86_64-with-glibc2.31\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5148/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5148/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5144","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5144/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5144/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5144/events","html_url":"https://github.com/mitmproxy/mitmproxy/pull/5144","id":1143677883,"node_id":"PR_kwDOAAfumM4zHfy7","number":5144,"title":"Http2 keepalive","user":{"login":"EndUser509","id":42170559,"node_id":"MDQ6VXNlcjQyMTcwNTU5","avatar_url":"https://avatars.githubusercontent.com/u/42170559?v=4","gravatar_id":"","url":"https://api.github.com/users/EndUser509","html_url":"https://github.com/EndUser509","followers_url":"https://api.github.com/users/EndUser509/followers","following_url":"https://api.github.com/users/EndUser509/following{/other_user}","gists_url":"https://api.github.com/users/EndUser509/gists{/gist_id}","starred_url":"https://api.github.com/users/EndUser509/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EndUser509/subscriptions","organizations_url":"https://api.github.com/users/EndUser509/orgs","repos_url":"https://api.github.com/users/EndUser509/repos","events_url":"https://api.github.com/users/EndUser509/events{/privacy}","received_events_url":"https://api.github.com/users/EndUser509/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2022-02-18T19:55:24Z","updated_at":"2022-03-23T12:15:07Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/pulls/5144","html_url":"https://github.com/mitmproxy/mitmproxy/pull/5144","diff_url":"https://github.com/mitmproxy/mitmproxy/pull/5144.diff","patch_url":"https://github.com/mitmproxy/mitmproxy/pull/5144.patch","merged_at":null},"body":"#### Description\r\n\r\nThis is a first PR for the implementation of the HTTP/2 keep-alive via ping as discussed in #5044 and the subsequent open issue #5046. \r\n\r\nI am open about naming of options, classes and functions, just tell me what you would like. The RequestKeepAlive command can be extended with a version int to deal with future HTTP versions that require a similar strategy but other intervals and messages.\r\n\r\nQuestions that I am not sure:\r\n - Keeping connections alive leads to more concurrently open connections. On my iPad I managed to get beyond 1200 open file handles on my Linux mitmproxy. Is that an issue?\r\n - Is there any additional safety needed in case somebody toys with layers, like accepting but ignoring events or commands in other layers?\r\n \r\n#### Checklist\r\n\r\n - [X] I have updated tests where applicable.\r\n - [ ] I have added an entry to the CHANGELOG.\r\n","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5144/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5144/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5134","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5134/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5134/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5134/events","html_url":"https://github.com/mitmproxy/mitmproxy/pull/5134","id":1138125291,"node_id":"PR_kwDOAAfumM4y1D0H","number":5134,"title":"Add support for XDG standard","user":{"login":"jrabinow","id":5642686,"node_id":"MDQ6VXNlcjU2NDI2ODY=","avatar_url":"https://avatars.githubusercontent.com/u/5642686?v=4","gravatar_id":"","url":"https://api.github.com/users/jrabinow","html_url":"https://github.com/jrabinow","followers_url":"https://api.github.com/users/jrabinow/followers","following_url":"https://api.github.com/users/jrabinow/following{/other_user}","gists_url":"https://api.github.com/users/jrabinow/gists{/gist_id}","starred_url":"https://api.github.com/users/jrabinow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jrabinow/subscriptions","organizations_url":"https://api.github.com/users/jrabinow/orgs","repos_url":"https://api.github.com/users/jrabinow/repos","events_url":"https://api.github.com/users/jrabinow/events{/privacy}","received_events_url":"https://api.github.com/users/jrabinow/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-02-15T03:21:07Z","updated_at":"2022-03-19T16:20:41Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/pulls/5134","html_url":"https://github.com/mitmproxy/mitmproxy/pull/5134","diff_url":"https://github.com/mitmproxy/mitmproxy/pull/5134.diff","patch_url":"https://github.com/mitmproxy/mitmproxy/pull/5134.patch","merged_at":null},"body":"#### Description\r\n\r\nAdd support for [XDG standard](https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html)\r\n\r\nhttps://github.com/mitmproxy/mitmproxy/pull/3950 seems to be in limbo, so I have implemented my own version.\r\n\r\nI'd like to draw attention to the following points:\r\n- `config.{yaml, yml}` and `keys.yaml` go under `${XDG_CONFIG_HOME:-~/.config}/mitmproxy`. However command history and anything cert-related probably count as data, not as configs, so I made them go under `${XDG_DATA_HOME:-~/.local/share}/mitmproxy`. I have also added a new option `datadir`.\r\n - xdg directories are purely opt-in: this PR does not move or remove support for `~/.mitmproxy` dir. Users can choose to move their files to `$XDG_CONFIG_HOME/mitmproxy` and `$XDG_DATA_HOME/mitmproxy` if they like. If the user doesn't manually perform the migration, they will see no change.\r\n\r\nDifferences compared to the discussion on https://github.com/mitmproxy/mitmproxy/pull/3950:\r\n- I have not exposed a `path.Pathlib` object. It's a bit more work but I don't have any problem with doing so if it's still desirable.\r\n- I have not \"killed `~/.mitmproxy` with fire\" despite it being suggested in the original discussion, as that would imply figuring out a migration path. I would recommend against breaking users setup on upgrade without warning beforehand, so this migration path would mean at least 2 releases, one with a warning that asks users to perform the migration, and the second which drops support for `~/.mitmproxy`. Then again, if the maintainers prefer migrating all users to xdg directories and would like to just migrate everyone in one go, I can change the code to do that.\r\n- >How about we add a section at the beginning of https://docs.mitmproxy.org/stable/concepts-options/ that looks as follows?\r\n\r\n  I have not taken this approach as the code is written in a way to make using xdg directories indefinitely purely opt-in. As such, I'd say it's reasonable to assume that people who take the manual steps to opt-in will be aware of their config situation. Please let me know if you'd prefer to add a new section at the beginning of `concepts-options.md` anyways.\r\n\r\nQuestions:\r\n - As of this moment, the value for `confdir` is hardcoded in `app.js` and I'm wary of writing code in `web/src/js/ducks/_options_gen.ts` as it seems to be autogenerated. What would be the best course of action here if any?\r\n - I'm not sure why tests are failing on `windows-latest, 3.9`, maybe my patch isn't working on that platform? I would special-case for windows but `windows-2019, windows` tests are running so I'm not sure if that's an option. If anyone had pointers, they would be appreciated\r\n\r\n#### Checklist\r\n\r\n - [x] I have updated tests where applicable.\r\n - [x] I have added an entry to the CHANGELOG.\r\n","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5134/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5134/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5133","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5133/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5133/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5133/events","html_url":"https://github.com/mitmproxy/mitmproxy/pull/5133","id":1137547316,"node_id":"PR_kwDOAAfumM4yzINe","number":5133,"title":"Exit with meaningful exit codes when we cannot write logs, fixes #4669","user":{"login":"Prinzhorn","id":679144,"node_id":"MDQ6VXNlcjY3OTE0NA==","avatar_url":"https://avatars.githubusercontent.com/u/679144?v=4","gravatar_id":"","url":"https://api.github.com/users/Prinzhorn","html_url":"https://github.com/Prinzhorn","followers_url":"https://api.github.com/users/Prinzhorn/followers","following_url":"https://api.github.com/users/Prinzhorn/following{/other_user}","gists_url":"https://api.github.com/users/Prinzhorn/gists{/gist_id}","starred_url":"https://api.github.com/users/Prinzhorn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Prinzhorn/subscriptions","organizations_url":"https://api.github.com/users/Prinzhorn/orgs","repos_url":"https://api.github.com/users/Prinzhorn/repos","events_url":"https://api.github.com/users/Prinzhorn/events{/privacy}","received_events_url":"https://api.github.com/users/Prinzhorn/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2022-02-14T16:29:17Z","updated_at":"2022-03-30T12:32:18Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":true,"pull_request":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/pulls/5133","html_url":"https://github.com/mitmproxy/mitmproxy/pull/5133","diff_url":"https://github.com/mitmproxy/mitmproxy/pull/5133.diff","patch_url":"https://github.com/mitmproxy/mitmproxy/pull/5133.patch","merged_at":null},"body":"#### Description\r\n\r\nThis fixes the 100% CPU loop for me.  I tried to introduce somewhat meaningful exit codes, feel free to change them. `CANNOT_WRITE_TO_DISK` is unused, not sure where that code even is that write the flow files. I ctrl+f for \"sys.exit\"\r\n","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5133/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5133/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5130","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5130/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5130/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5130/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/5130","id":1135660447,"node_id":"I_kwDOAAfumM5DsM2f","number":5130,"title":"--view-filter not recognized with mitmweb","user":{"login":"SecT0uch","id":26085417,"node_id":"MDQ6VXNlcjI2MDg1NDE3","avatar_url":"https://avatars.githubusercontent.com/u/26085417?v=4","gravatar_id":"","url":"https://api.github.com/users/SecT0uch","html_url":"https://github.com/SecT0uch","followers_url":"https://api.github.com/users/SecT0uch/followers","following_url":"https://api.github.com/users/SecT0uch/following{/other_user}","gists_url":"https://api.github.com/users/SecT0uch/gists{/gist_id}","starred_url":"https://api.github.com/users/SecT0uch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SecT0uch/subscriptions","organizations_url":"https://api.github.com/users/SecT0uch/orgs","repos_url":"https://api.github.com/users/SecT0uch/repos","events_url":"https://api.github.com/users/SecT0uch/events{/privacy}","received_events_url":"https://api.github.com/users/SecT0uch/received_events","type":"User","site_admin":false},"labels":[{"id":79336545,"node_id":"MDU6TGFiZWw3OTMzNjU0NQ==","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/kind/feature","name":"kind/feature","color":"207de5","default":false,"description":"New features / enhancements"},{"id":429891082,"node_id":"MDU6TGFiZWw0Mjk4OTEwODI=","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/area/web","name":"area/web","color":"fef2c0","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2022-02-13T11:01:36Z","updated_at":"2022-02-16T15:35:25Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"#### Problem Description\r\nAs per [the docunentation](https://docs.mitmproxy.org/stable/concepts-options/#available-options), the option `--view_filter` should be available for mitmweb. However it seems it's not.\r\n\r\nAs a side note, a parameter for the \"Highlight\" option would also be useful.\r\n\r\n#### Steps to reproduce the behavior:\r\n1. `mitmweb --view-filter '~d lol.org'`\r\n\r\n#### System Information\r\nMitmproxy: 7.0.4\r\nPython:    3.10.2\r\nOpenSSL:   OpenSSL 1.1.1m  14 Dec 2021\r\nPlatform:  Linux-5.16.7-1-MANJARO-x86_64-with-glibc2.33","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5130/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5130/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5091","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5091/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5091/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5091/events","html_url":"https://github.com/mitmproxy/mitmproxy/pull/5091","id":1114468530,"node_id":"PR_kwDOAAfumM4xlq01","number":5091,"title":"Add support for grpc viewing and modification using protoc","user":{"login":"aarnaut","id":13184484,"node_id":"MDQ6VXNlcjEzMTg0NDg0","avatar_url":"https://avatars.githubusercontent.com/u/13184484?v=4","gravatar_id":"","url":"https://api.github.com/users/aarnaut","html_url":"https://github.com/aarnaut","followers_url":"https://api.github.com/users/aarnaut/followers","following_url":"https://api.github.com/users/aarnaut/following{/other_user}","gists_url":"https://api.github.com/users/aarnaut/gists{/gist_id}","starred_url":"https://api.github.com/users/aarnaut/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aarnaut/subscriptions","organizations_url":"https://api.github.com/users/aarnaut/orgs","repos_url":"https://api.github.com/users/aarnaut/repos","events_url":"https://api.github.com/users/aarnaut/events{/privacy}","received_events_url":"https://api.github.com/users/aarnaut/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-01-25T23:34:29Z","updated_at":"2022-03-19T16:20:41Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/pulls/5091","html_url":"https://github.com/mitmproxy/mitmproxy/pull/5091","diff_url":"https://github.com/mitmproxy/mitmproxy/pull/5091.diff","patch_url":"https://github.com/mitmproxy/mitmproxy/pull/5091.patch","merged_at":null},"body":"#### Description\r\n\r\nFixes #5001.\r\nThis PR addresses #5001 with some adjustments. We use text format provided by the protobuf library instead of JSON to present the protobuf content. The reason for that is the lack of ability to represent unknown fields with JSON.\r\n\r\nThe current implementation for modification only works on console. I've tried to make this more explicit in the name itself.\r\nIt relies on a command addon, which is not supported in web. Viewing works both in console and web.\r\n\r\nI have a couple of checks failing and I'm unable to resolve them. I would appreciate if you could give me some pointers.\r\n\r\n#### Open points\r\n - Current implementation only allows for uncompressed payload. I don't think there would be issues with adding this in the future. I've checked the existing `grpc` implementation and we could probably do something similar.\r\n - Message resolution works based on path. For example, HTTP path `example/server/GetUser` will resolve into `example.server.GetUser` and we will do an RPC lookup based on this name. I've only worked on services with this kind of mapping. I haven't managed to find any resources on whether this is a standard, so I'm a bit concerned if this method is correct. Perhaps it would make sense to introduce a way to provide custom mappings.\r\n- I have yet to verify this, but I believe that `modify_body` will not work correctly with this extension. The reason is that protobuf is a binary format. Maybe there's a way to extend this and add this support as well.\r\n- I think it would make sense to mark this addon/contenview as experimental for the time being. I also have to write some docs. What would be the right way to go about this?\r\n\r\n#### Checklist\r\n\r\n - [X] I have updated tests where applicable.\r\n - [x] I have added an entry to the CHANGELOG.","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5091/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5091/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5085","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5085/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5085/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5085/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/5085","id":1110728687,"node_id":"I_kwDOAAfumM5CNF_v","number":5085,"title":"`Set-Cookie` header not set properly when cookies are modified ","user":{"login":"Speedlulu","id":26604856,"node_id":"MDQ6VXNlcjI2NjA0ODU2","avatar_url":"https://avatars.githubusercontent.com/u/26604856?v=4","gravatar_id":"","url":"https://api.github.com/users/Speedlulu","html_url":"https://github.com/Speedlulu","followers_url":"https://api.github.com/users/Speedlulu/followers","following_url":"https://api.github.com/users/Speedlulu/following{/other_user}","gists_url":"https://api.github.com/users/Speedlulu/gists{/gist_id}","starred_url":"https://api.github.com/users/Speedlulu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Speedlulu/subscriptions","organizations_url":"https://api.github.com/users/Speedlulu/orgs","repos_url":"https://api.github.com/users/Speedlulu/repos","events_url":"https://api.github.com/users/Speedlulu/events{/privacy}","received_events_url":"https://api.github.com/users/Speedlulu/received_events","type":"User","site_admin":false},"labels":[{"id":79336502,"node_id":"MDU6TGFiZWw3OTMzNjUwMg==","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/kind/bug","name":"kind/bug","color":"d93f0b","default":false,"description":null},{"id":429896009,"node_id":"MDU6TGFiZWw0Mjk4OTYwMDk=","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/area/protocols","name":"area/protocols","color":"fef2c0","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2022-01-21T17:38:12Z","updated_at":"2022-01-27T12:54:41Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"#### Problem Description\r\nDescribed here https://github.com/mitmproxy/mitmproxy/pull/5084\r\n\r\n#### Steps to reproduce the behavior:\r\n1. Have a server set a cookie with en empty attributes (`Secure`, `HttpOnly` ...)\r\n2. Edit `CookieAttrs` object of said object\r\n3. Assign `(value, CookieAttrs)` tuple to the `flow.response.cookies` object\r\n4. Response header will now have empty attribute in `Set-Cookie` header set as `Secure=; HttpOnly=`\r\n\r\n#### System Information\r\nMitmproxy: 7.0.4\r\nPython:    3.8.10\r\nOpenSSL:   OpenSSL 1.1.1l  24 Aug 2021\r\nPlatform:  Linux-5.11.0-46-generic-x86_64-with-glibc2.29\r\n\r\n#### Pull request\r\nI have created a pull request (https://github.com/mitmproxy/mitmproxy/pull/5084) to try to fix the issue, it works well for my use but it might break parts of the app that I'm not aware and/or don't use.\r\n","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5085/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5085/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5084","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5084/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5084/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5084/events","html_url":"https://github.com/mitmproxy/mitmproxy/pull/5084","id":1110680348,"node_id":"PR_kwDOAAfumM4xZRbt","number":5084,"title":"Parse set header cookies properly","user":{"login":"Speedlulu","id":26604856,"node_id":"MDQ6VXNlcjI2NjA0ODU2","avatar_url":"https://avatars.githubusercontent.com/u/26604856?v=4","gravatar_id":"","url":"https://api.github.com/users/Speedlulu","html_url":"https://github.com/Speedlulu","followers_url":"https://api.github.com/users/Speedlulu/followers","following_url":"https://api.github.com/users/Speedlulu/following{/other_user}","gists_url":"https://api.github.com/users/Speedlulu/gists{/gist_id}","starred_url":"https://api.github.com/users/Speedlulu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Speedlulu/subscriptions","organizations_url":"https://api.github.com/users/Speedlulu/orgs","repos_url":"https://api.github.com/users/Speedlulu/repos","events_url":"https://api.github.com/users/Speedlulu/events{/privacy}","received_events_url":"https://api.github.com/users/Speedlulu/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-01-21T16:43:06Z","updated_at":"2022-03-19T16:20:41Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/pulls/5084","html_url":"https://github.com/mitmproxy/mitmproxy/pull/5084","diff_url":"https://github.com/mitmproxy/mitmproxy/pull/5084.diff","patch_url":"https://github.com/mitmproxy/mitmproxy/pull/5084.patch","merged_at":null},"body":"#### Description\r\n\r\nCurrently when an empty cookie attribute (`Secure`, `HttpOnly` ...) is encountered while parsing a `Set-Cookie` header it will create a `CookieAttrs` object containing a (key, value) pair with an empty string for the attribute value ie:\r\n\r\n```python\r\nCookieAttrs[('Secure', ''), ('HttpOnly', ''), ('Path', '/')]\r\n``` \r\nResulting in an updated `Set-Cookie` header for the `Response` object with invalid values for those empty attributes ie:\r\n```python\r\n(b'SetCookie', b'value=XYZ; Secure=; HttpOnly=; Path=/')\r\n``` \r\nMy browser (Firefox 95.0.1) does not pickup these attributes so the cookie looses them.\r\n\r\n______\r\n\r\nThis fix replaces the empty string attribute for empty cookie attributes by the value `None` ie:\r\n\r\n```python\r\nCookieAttrs[('Secure', None), ('HttpOnly', None), ('Path', '/')]\r\n``` \r\n\r\nSo that they can be told apart from attributes with intentional empty string values when setting the updated header, which results in a properly formatted header:\r\n\r\n```python\r\n(b'SetCookie', b'value=XYZ; Secure; HttpOnly; Path=/')\r\n``` \r\n\r\n#### Checklist\r\n\r\n - [x] I have updated tests where applicable.\r\n - [x] I have added an entry to the CHANGELOG.\r\n","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5084/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5084/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5069","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5069/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5069/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5069/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/5069","id":1105861403,"node_id":"I_kwDOAAfumM5B6hsb","number":5069,"title":"CLI options should take precedence over config ones","user":{"login":"marwinxxii","id":679204,"node_id":"MDQ6VXNlcjY3OTIwNA==","avatar_url":"https://avatars.githubusercontent.com/u/679204?v=4","gravatar_id":"","url":"https://api.github.com/users/marwinxxii","html_url":"https://github.com/marwinxxii","followers_url":"https://api.github.com/users/marwinxxii/followers","following_url":"https://api.github.com/users/marwinxxii/following{/other_user}","gists_url":"https://api.github.com/users/marwinxxii/gists{/gist_id}","starred_url":"https://api.github.com/users/marwinxxii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marwinxxii/subscriptions","organizations_url":"https://api.github.com/users/marwinxxii/orgs","repos_url":"https://api.github.com/users/marwinxxii/repos","events_url":"https://api.github.com/users/marwinxxii/events{/privacy}","received_events_url":"https://api.github.com/users/marwinxxii/received_events","type":"User","site_admin":false},"labels":[{"id":79336545,"node_id":"MDU6TGFiZWw3OTMzNjU0NQ==","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/kind/feature","name":"kind/feature","color":"207de5","default":false,"description":"New features / enhancements"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-01-17T13:30:31Z","updated_at":"2022-01-17T13:30:31Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"#### Problem Description\r\n\r\nCurrently it is not possible to override an option defined in the config file using a command line argument.\r\n\r\n#### Proposal\r\nIf option is defined in a config file and as a command line argument, CLI argument value should be used.\r\n\r\n#### Alternatives\r\nNone?\r\n\r\n#### Additional context\r\nRaised here https://github.com/mitmproxy/mitmproxy/pull/5067/files?#diff-09a1c1f8266892ca175be0f084c26b7972c1919f413b5e70fb9095e94a7468e0R79\r\n","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5069/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5069/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5065","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5065/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5065/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5065/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/5065","id":1104906893,"node_id":"I_kwDOAAfumM5B24qN","number":5065,"title":"Change connect/disconnect log messages loglevel from info to debug","user":{"login":"ericdraken","id":22000765,"node_id":"MDQ6VXNlcjIyMDAwNzY1","avatar_url":"https://avatars.githubusercontent.com/u/22000765?v=4","gravatar_id":"","url":"https://api.github.com/users/ericdraken","html_url":"https://github.com/ericdraken","followers_url":"https://api.github.com/users/ericdraken/followers","following_url":"https://api.github.com/users/ericdraken/following{/other_user}","gists_url":"https://api.github.com/users/ericdraken/gists{/gist_id}","starred_url":"https://api.github.com/users/ericdraken/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ericdraken/subscriptions","organizations_url":"https://api.github.com/users/ericdraken/orgs","repos_url":"https://api.github.com/users/ericdraken/repos","events_url":"https://api.github.com/users/ericdraken/events{/privacy}","received_events_url":"https://api.github.com/users/ericdraken/received_events","type":"User","site_admin":false},"labels":[{"id":79336545,"node_id":"MDU6TGFiZWw3OTMzNjU0NQ==","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/kind/feature","name":"kind/feature","color":"207de5","default":false,"description":"New features / enhancements"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-01-16T00:48:34Z","updated_at":"2022-01-16T19:20:32Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"#### Problem Description\r\n\r\nThis is unnecessary noise is `mitmdump`:\r\n\r\n```\r\n172.31.1.105:62713: client connect\r\n172.31.1.105:62714: client connect\r\n172.31.1.105:62715: client connect\r\n172.31.1.105:62716: client connect\r\n172.31.1.105:62717: client connect\r\n172.31.1.105:62718: client connect\r\n```\r\n\r\n#### Proposal\r\n\r\nHere is a patch I currently use:\r\n\r\n```\r\nIndex: mitmdump/server.py\r\nIDEA additional info:\r\nSubsystem: com.intellij.openapi.diff.impl.patch.CharsetEP\r\n<+>UTF-8\r\n===================================================================\r\ndiff --git a/mitmdump/server.py b/mitmdump/server.py\r\n--- a/mitmdump/server.py\t(revision ebda1299328c3b8ed119d8a92fbe56efc4dbecdc)\r\n+++ b/mitmdump/server.py\t(date 1642293443597)\r\n@@ -98,7 +98,7 @@\r\n         if not watch:\r\n             return  # this should not be needed, see asyncio_utils.create_task\r\n \r\n-        self.log(\"client connect\")\r\n+        self.log(\"client connect\", \"debug\")\r\n         await self.handle_hook(server_hooks.ClientConnectedHook(self.client))\r\n         if self.client.error:\r\n             self.log(\"client kill connection\")\r\n@@ -119,7 +119,7 @@\r\n \r\n         watch.cancel()\r\n \r\n-        self.log(\"client disconnect\")\r\n+        self.log(\"client disconnect\", \"debug\")\r\n         self.client.timestamp_end = time.time()\r\n         await self.handle_hook(server_hooks.ClientDisconnectedHook(self.client))\r\n \r\n@@ -173,7 +173,7 @@\r\n                     addr = f\"{human.format_address(command.connection.address)} ({human.format_address(command.connection.peername)})\"\r\n                 else:\r\n                     addr = human.format_address(command.connection.address)\r\n-                self.log(f\"server connect {addr}\")\r\n+                self.log(f\"server connect {addr}\", \"debug\")\r\n                 connected_hook = asyncio_utils.create_task(\r\n                     self.handle_hook(server_hooks.ServerConnectedHook(hook_data)),\r\n                     name=f\"handle_hook(server_connected) {addr}\",\r\n@@ -197,7 +197,7 @@\r\n                 self.transports[command.connection].handler = new_handler\r\n                 await asyncio.wait([new_handler])\r\n \r\n-                self.log(f\"server disconnect {addr}\")\r\n+                self.log(f\"server disconnect {addr}\", \"debug\")\r\n                 command.connection.timestamp_end = time.time()\r\n                 await connected_hook  # wait here for this so that closed always comes after connected.\r\n                 await self.handle_hook(server_hooks.ServerDisconnectedHook(hook_data))\r\n@@ -252,7 +252,7 @@\r\n             raise cancelled\r\n \r\n     async def on_timeout(self) -> None:\r\n-        self.log(f\"Closing connection due to inactivity: {self.client}\")\r\n+        self.log(f\"Closing connection due to inactivity: {self.client}\", \"debug\")\r\n         handler = self.transports[self.client].handler\r\n         assert handler\r\n         asyncio_utils.cancel_task(handler, \"timeout\")\r\n\r\n```\r\n\r\nResult:\r\n\r\n![image](https://user-images.githubusercontent.com/22000765/149642981-d758ad27-2a02-4918-b977-22bccbded52f.png)\r\n\r\n#### Alternatives\r\n\r\n(Hack) Set loglevel to \"error\" and create/use a custom module to log messages from hooks as 'errors'.\r\n\r\n#### Additional context\r\nN/A\r\n","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5065/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5065/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5064","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5064/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5064/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5064/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/5064","id":1104900332,"node_id":"I_kwDOAAfumM5B23Ds","number":5064,"title":"Allow Server SNI Interrogation in Transparent Mode","user":{"login":"ericdraken","id":22000765,"node_id":"MDQ6VXNlcjIyMDAwNzY1","avatar_url":"https://avatars.githubusercontent.com/u/22000765?v=4","gravatar_id":"","url":"https://api.github.com/users/ericdraken","html_url":"https://github.com/ericdraken","followers_url":"https://api.github.com/users/ericdraken/followers","following_url":"https://api.github.com/users/ericdraken/following{/other_user}","gists_url":"https://api.github.com/users/ericdraken/gists{/gist_id}","starred_url":"https://api.github.com/users/ericdraken/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ericdraken/subscriptions","organizations_url":"https://api.github.com/users/ericdraken/orgs","repos_url":"https://api.github.com/users/ericdraken/repos","events_url":"https://api.github.com/users/ericdraken/events{/privacy}","received_events_url":"https://api.github.com/users/ericdraken/received_events","type":"User","site_admin":false},"labels":[{"id":79336545,"node_id":"MDU6TGFiZWw3OTMzNjU0NQ==","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/kind/feature","name":"kind/feature","color":"207de5","default":false,"description":"New features / enhancements"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2022-01-16T00:20:57Z","updated_at":"2022-01-17T20:39:07Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"#### Problem Description\r\n\r\nThe sever SNI is not added to the array of hostnames checked against `ignored-hosts` and `allowed-hosts` in `next_layer.py` so some requests get past the respective filters.\r\n\r\n#### Proposal\r\n\r\nHere is a patch I currently use myself that I'd like to share (7.0.4):\r\n\r\n```diff\r\nIndex: venv/lib/python3.8/site-packages/mitmproxy/addons/next_layer.py\r\nIDEA additional info:\r\nSubsystem: com.intellij.openapi.diff.impl.patch.CharsetEP\r\n<+>UTF-8\r\n===================================================================\r\ndiff --git a/usr/local/lib/python3.8/site-packages/mitmproxy/addons/next_layer.py b/usr/local/lib/python3.8/site-packages/mitmproxy/addons/next_layer.py\r\n--- a/usr/local/lib/python3.8/site-packages/mitmproxy/addons/next_layer.py  (date 1641187083049)\r\n+++ b/usr/local/lib/python3.8/site-packages/mitmproxy/addons/next_layer.py  (date 1641187083049)\r\n@@ -59,7 +59,7 @@\r\n                 re.compile(x, re.IGNORECASE) for x in ctx.options.allow_hosts\r\n             ]\r\n \r\n-    def ignore_connection(self, server_address: Optional[connection.Address], data_client: bytes) -> Optional[bool]:\r\n+    def ignore_connection(self, server: Optional[connection.Server], data_client: bytes) -> Optional[bool]:\r\n         \"\"\"\r\n         Returns:\r\n             True, if the connection should be ignored.\r\n@@ -70,8 +70,11 @@\r\n             return False\r\n \r\n         hostnames: List[str] = []\r\n-        if server_address is not None:\r\n-            hostnames.append(server_address[0])\r\n+        if server is not None:\r\n+            if server.address is not None:\r\n+                hostnames.append(server.address[0])\r\n+            if server.sni is not None:\r\n+                hostnames.append(server.sni)\r\n         if is_tls_record_magic(data_client):\r\n             try:\r\n                 ch = parse_client_hello(data_client)\r\n@@ -122,7 +125,7 @@\r\n             return stack_match(context, layers)\r\n \r\n         # 1. check for --ignore/--allow\r\n-        ignore = self.ignore_connection(context.server.address, data_client)\r\n+        ignore = self.ignore_connection(context.server, data_client)\r\n         if ignore is True:\r\n             return layers.TCPLayer(context, ignore=True)\r\n         if ignore is None:\r\n```\r\n\r\n#### Alternatives\r\nN/A\r\n\r\n#### Additional context\r\n\r\nHere is a write-up I made about why this patch is needed: https://ericdraken.com/pfsense-decrypt-ad-traffic/#patch\r\n","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5064/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5064/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5063","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5063/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5063/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5063/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/5063","id":1104898338,"node_id":"I_kwDOAAfumM5B22ki","number":5063,"title":"Automatically add FQDNs using Pinned Certs to the Ignored Hosts regex","user":{"login":"ericdraken","id":22000765,"node_id":"MDQ6VXNlcjIyMDAwNzY1","avatar_url":"https://avatars.githubusercontent.com/u/22000765?v=4","gravatar_id":"","url":"https://api.github.com/users/ericdraken","html_url":"https://github.com/ericdraken","followers_url":"https://api.github.com/users/ericdraken/followers","following_url":"https://api.github.com/users/ericdraken/following{/other_user}","gists_url":"https://api.github.com/users/ericdraken/gists{/gist_id}","starred_url":"https://api.github.com/users/ericdraken/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ericdraken/subscriptions","organizations_url":"https://api.github.com/users/ericdraken/orgs","repos_url":"https://api.github.com/users/ericdraken/repos","events_url":"https://api.github.com/users/ericdraken/events{/privacy}","received_events_url":"https://api.github.com/users/ericdraken/received_events","type":"User","site_admin":false},"labels":[{"id":79336545,"node_id":"MDU6TGFiZWw3OTMzNjU0NQ==","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/kind/feature","name":"kind/feature","color":"207de5","default":false,"description":"New features / enhancements"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2022-01-16T00:13:06Z","updated_at":"2022-01-16T19:41:51Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"#### Problem Description\r\n\r\nMore and more sites are using cert pinning. These domains need to be added manually to `ignore-hosts`.\r\n\r\n#### Proposal\r\n\r\nIf a pinned cert is detected/suspected, update the regex for `ignore-hosts` in the `next_layer.py` in situ.\r\n\r\n#### Alternatives\r\n\r\n(Hack) Grep the logs for \"If this happens consistently for <FQDN>, this may indicate that the client does not trust the proxy's certificate.\", update a config or the CLI `--ignore-hosts` option, and force a `mitmproxy` restart.\r\n\r\n#### Additional context\r\nN/A\r\n","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5063/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5063/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5050","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5050/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5050/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5050/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/5050","id":1100612534,"node_id":"I_kwDOAAfumM5BmgO2","number":5050,"title":"AssertionError: Unexpected event: <InformationalResponseReceived","user":{"login":"Prinzhorn","id":679144,"node_id":"MDQ6VXNlcjY3OTE0NA==","avatar_url":"https://avatars.githubusercontent.com/u/679144?v=4","gravatar_id":"","url":"https://api.github.com/users/Prinzhorn","html_url":"https://github.com/Prinzhorn","followers_url":"https://api.github.com/users/Prinzhorn/followers","following_url":"https://api.github.com/users/Prinzhorn/following{/other_user}","gists_url":"https://api.github.com/users/Prinzhorn/gists{/gist_id}","starred_url":"https://api.github.com/users/Prinzhorn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Prinzhorn/subscriptions","organizations_url":"https://api.github.com/users/Prinzhorn/orgs","repos_url":"https://api.github.com/users/Prinzhorn/repos","events_url":"https://api.github.com/users/Prinzhorn/events{/privacy}","received_events_url":"https://api.github.com/users/Prinzhorn/received_events","type":"User","site_admin":false},"labels":[{"id":79336502,"node_id":"MDU6TGFiZWw3OTMzNjUwMg==","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/kind/bug","name":"kind/bug","color":"d93f0b","default":false,"description":null},{"id":429896009,"node_id":"MDU6TGFiZWw0Mjk4OTYwMDk=","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/area/protocols","name":"area/protocols","color":"fef2c0","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2022-01-12T17:34:22Z","updated_at":"2022-03-26T10:27:50Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"I don't think this was broken recently, originally happened on a pretty outdated branch of mine (as far back as c718d4f7b0fb98bcab90bc09608f899c27790237) but repros on main as well\r\n\r\n#### Steps to reproduce the behavior:\r\n1. `mitmdump`\r\n2. `curl --insecure --proxy localhost:8080 https://www.shopify.com/`\r\n\r\n```\r\n127.0.0.1:40186: client connect\r\n127.0.0.1:40186: server connect www.shopify.com:443 (104.16.255.71:443)\r\n127.0.0.1:40186: mitmproxy has crashed!\r\nTraceback (most recent call last):\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/server.py\", line 294, in server_event\r\n    for command in layer_commands:\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/layer.py\", line 144, in handle_event\r\n    command = command_generator.send(send)\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/layer.py\", line 255, in handle_event\r\n    yield from self._handle(event)\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/layer.py\", line 144, in handle_event\r\n    command = command_generator.send(send)\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/layers/http/__init__.py\", line 742, in _handle_event\r\n    yield from self.event_to_child(handler, event)\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/layers/http/__init__.py\", line 751, in event_to_child\r\n    for command in child.handle_event(event):\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/layer.py\", line 144, in handle_event\r\n    command = command_generator.send(send)\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/layers/http/__init__.py\", line 619, in passthrough\r\n    for command in self.child_layer.handle_event(event):\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/layer.py\", line 144, in handle_event\r\n    command = command_generator.send(send)\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/tunnel.py\", line 75, in _handle_event\r\n    yield from self.receive_data(event.data)\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/layers/tls.py\", line 291, in receive_data\r\n    yield from self.event_to_child(\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/layers/tls.py\", line 357, in event_to_child\r\n    yield from super().event_to_child(event)\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/tunnel.py\", line 109, in event_to_child\r\n    for command in self.child_layer.handle_event(event):\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/layer.py\", line 144, in handle_event\r\n    command = command_generator.send(send)\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/tunnel.py\", line 90, in _handle_event\r\n    yield from self.event_to_child(event)\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/tunnel.py\", line 109, in event_to_child\r\n    for command in self.child_layer.handle_event(event):\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/layer.py\", line 144, in handle_event\r\n    command = command_generator.send(send)\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/layers/http/__init__.py\", line 742, in _handle_event\r\n    yield from self.event_to_child(handler, event)\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/layers/http/__init__.py\", line 751, in event_to_child\r\n    for command in child.handle_event(event):\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/layer.py\", line 144, in handle_event\r\n    command = command_generator.send(send)\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/layer.py\", line 144, in handle_event\r\n    command = command_generator.send(send)\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/layers/http/_http2.py\", line 381, in _handle_event\r\n    for cmd in self._handle_event2(event):\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/layers/http/_http2.py\", line 425, in _handle_event2\r\n    yield from super()._handle_event(event)\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/layers/http/_http2.py\", line 156, in _handle_event\r\n    if (yield from self.handle_h2_event(h2_event)):\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/layers/http/_http2.py\", line 461, in handle_h2_event\r\n    return (yield from super().handle_h2_event(event))\r\n  File \"/home/alex/src/forks/mitmproxy/mitmproxy/proxy/layers/http/_http2.py\", line 234, in handle_h2_event\r\n    raise AssertionError(f\"Unexpected event: {event!r}\")\r\nAssertionError: Unexpected event: <InformationalResponseReceived stream_id:1, headers:[(b':status', b'103'), (b'link', b'<https://cdn.shopify.com/shopifycloud/brochure/assets/application-e4598a9a40dfeaa77f3cfb05d6d502d3e2f0020008fdfcc09747333d2666c424.css>; as=style; rel=preload, <https://cdn.shopify.com/shopifycloud/brochure/assets/manifests/home/index-c9203e6aecacc53dbe4781dc6fe3805ab20876c009b62307490723e3b96de5ea.css>; as=style; rel=preload')]>\r\n\r\n127.0.0.1:40186: GET https://www.shopify.com/ HTTP/2.0\r\n     << HTTP/2.0 200 OK 160k\r\n127.0.0.1:40186: client disconnect\r\n127.0.0.1:40186: server disconnect www.shopify.com:443 (104.16.255.71:443)\r\n```\r\n\r\n#### System Information\r\nPaste the output of \"mitmproxy --version\" here.\r\n\r\n```\r\nMitmproxy: 8.0.0.dev (+202, commit 1e97073)\r\nPython:    3.8.10\r\nOpenSSL:   OpenSSL 1.1.1m  14 Dec 2021\r\nPlatform:  Linux-5.11.0-46-generic-x86_64-with-glibc2.29\r\n```","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5050/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5050/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5048","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5048/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5048/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5048/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/5048","id":1098950777,"node_id":"I_kwDOAAfumM5BgKh5","number":5048,"title":"Google Summer of Code 2022","user":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","site_admin":false},"labels":[{"id":911560442,"node_id":"MDU6TGFiZWw5MTE1NjA0NDI=","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/gsoc","name":"gsoc","color":"5319e7","default":false,"description":"Google Summer of Code"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-01-11T10:14:27Z","updated_at":"2022-03-30T12:53:50Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"[![gsoc](https://cloud.githubusercontent.com/assets/1019198/22106433/058d5a26-de49-11e6-893e-6a5ff97ffe78.png)](https://summerofcode.withgoogle.com/)\r\n<p  align=\"center\">\r\n<a href=\"https://honeynet.org\">&nbsp;<img height=80 src=\"https://austria2019.honeynet.org/images/logo-text.png\"></a>\r\n</p>\r\n\r\nMitmproxy is participating under the umbrella of the [Honeynet project](https://www.honeynet.org/) in the [Google Summer of Code 2022](https://summerofcode.withgoogle.com/). \r\nIn short, GSoC participants can get involved into the mitmproxy community for ~12 weeks, contribute code, \r\nand receive [an attractive stipend](https://developers.google.com/open-source/gsoc/help/student-stipends) from Google for it! \r\n\r\nThis issue is targeted at potential participants to help them getting started and write a strong proposal. :smiley:\r\n\r\n# Getting Started\r\n\r\n1. Decide to apply for GSoC.\r\n2. Write a project proposal for your application.\r\n3. Reach out to @mhils on Slack to get feedback!\r\n\r\n# Project Ideas\r\n\r\nmitmproxy is a large project with a huge number of interesting areas to explore, down from low-level protocol work up to UX improvements. You know best what you are interested in, so why not get in touch with us and map out a custom GSoC project? Here are some ideas for inspiration:\r\n\r\n - **Web UI (TypeScript/React.js):** If you like to hack on front-end code, we have a vast array of ideas for mitmweb, our HTML frontend for mitmproxy. Just some ideas:\r\n   - Add graphical editors for the map remote, map local, modify body, and modify headers settings.\r\n   - Add body search filters\r\n   - Improve the onboarding experience, e.g. by showing instructions on how to configure the proxy if no traffic has been captured yet.\r\n   - Develop functionality to edit and/or replay TCP messages before forwarding.\r\n - **Mitmproxy Core (Python):**\r\n   - Add a HAR Im- and Exporter to the core.\r\n   - https://github.com/mitmproxy/mitmproxy/issues/5231\r\n   - Many mitmproxy users want to use mitmproxy to just see all traffic of their current device without configuring individual applications, but that requires a complicated iptables configuration or undocumented scripts on Windows. You can make tremendous improvements to mitmproxy onboarding experience here! [#1261]\r\n   - Many mitmproxy users only want to proxy one specific application. We already have a [`browser.start` command](https://github.com/mitmproxy/mitmproxy/blob/ef69701b0a64df97fc92ed568d39eed987fe8bdf/mitmproxy/addons/browser.py#L29-L74) to boot up a Chrome instance, it would be very useful to have similar wrappers for Firefox, Edge, Safari, Docker Containers, or Android Devices!\r\n   - Add basic support for UDP Proxying\r\n   - Develop functionality to edit and/or replay TCP messages before forwarding.\r\n\r\n\r\n# Application Tips\r\n\r\nPicking the right students for a Google Summer of Code is hard - we really want to encourage all students to get involved with open source, but how do we determine who's best suited for a particular project? Here comes your part: Show us that you're super enthusiastic, that you can work autonomously and that you are capable of completing your project! :tada: \r\n\r\n#### Demonstrate that you are capable of fulfilling the project!\r\n\r\nWhile many of you probably have a good theoretical background from your university, you should show us that you can code as well:\r\n\r\n- Do you have a cool/interesting side project or university project? Show it to us! Even better if it's open source and we can read the code!\r\n- Have you contributed to an open source project before? Show us what you did!\r\n- No previous projects you could show? [Add a feature and/or fix a small bug](https://github.com/mitmproxy/mitmproxy/labels/help%20wanted) in mitmproxy!\r\n\r\nAs long as you have some code to show, please don't stress yourself about this part. We require a certain minimum level of technical proficiency so that GSoC is fun for everyone, but beyond that social components are way more important to us. 😃 \r\n\r\n#### Demonstrate that you want to contribute to mitmproxy specifically!\r\n\r\nGoogle accepts a variety of mentoring organizations every year, each of them with multiple projects. Now, why do you want to work on mitmproxy specifically? We do _not_ just want to hear a chorus of praise here (\"mitmproxy is a great tool\"). Instead, play around with it and tell us about your experiences:\r\n- Use mitmproxy to analyze a popular Android or iOS app or anything else. There are many hidden treasures/security issues to be found [[2]](https://corte.si/posts/security/skout/index.html)! Show us what you analyzed (screenshots), what you found, where mitmproxy was good/not good etc! :-)\r\n- Write a nice script that does something cool with a webpage! For example, we have an example script that turns all webpages upside down ([src](https://github.com/mitmproxy/mitmproxy/blob/main/examples/addons/internet-in-mirror.py)). Try to come up with something creative :-)\r\n- Again, a good way to show that you're a good candidate is to fix a bug, propose or implement a feature, add something that was unclear to you to the docs, etc.\r\n#### Get in touch!\r\n\r\nWe hang out on Slack (https://gsoc-slack.honeynet.org/ or the mitmproxy Slack). Feel free to just get in touch! :smiley:\r\n\r\n#### Make sure to have a plan!\r\n\r\nFor your GSoC proposal (please use [the template](https://gist.github.com/mhils/27e46c8a0caea135905d84f5d3a9f52b)), you need to write down a roadmap/timeline for your project. Think about which features you need to develop to accomplish your goal, split your project into subtasks and make sure that you'll end up with a viable timeline. Having at least one dedicated task per week would be a good way to track the progress of your project as well. If you already identified potential issues/caveats for your endeavour, make sure to discuss them in the proposal as well!\r\n\r\n**Last but not least:** GSoC is fun. Enjoy it! 😃 🍰 🚀 \r\n\r\n---\r\n# FAQ\r\n#### 1. There's a skilled and very motivated student already working hard on a proposal for the project I want to apply for. Should I even bother to apply?\r\n\r\nYes! First, if we get two convincing proposals for one project idea, we will try to just take both students¹. Second, if we cannot take you for some reason, we will actively introduce you to other projects at Honeynet that match your skills and interests after the application deadline². I can't stress this enough: Please do not worry about competition! If we see you cooperating with other contributors (students or not), this is a big plus.\r\n\r\n¹) This requires that the project can be split (and extended) in a way that there are no critical interdependencies between the students. You will not get a project which depends on another student's work.\r\n²) This is not just nice talk, we did this repeatedly with good outcomes. Some of those students are mentors now. 🙂 \r\n#### 2. I want to implement $MAJOR_FEATURE_X to show that I'm a super capable student!\r\n\r\nThis is great, but please please do not send us a single giant pull request! Please try to show us that you can split major tasks into small, (mostly) isolated parts. A PR is _never_ to small for first time contributors. :relaxed: \r\n\r\n#### 3. What is the team's preferred style of communication?\r\n\r\nAnswering every student's questions in a private conversation is often overwhelming for mentors during the peak GSoC application period. We therefore appreciate it if you ask your question publicly on GitHub or in #general on Slack so that others can help out as well. You are of course welcome to message us directly for feedback on your (already submitted) proposal, or if you feel umcomfortable discussing something in the open.\r\n\r\n#### 4. GSoC aside, how can I contribute to mitmproxy? \r\nCheck out https://github.com/mitmproxy/mitmproxy/blob/main/CONTRIBUTING.md! ","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5048/reactions","total_count":9,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":9,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5048/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5046","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5046/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5046/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5046/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/5046","id":1098804407,"node_id":"I_kwDOAAfumM5Bfmy3","number":5046,"title":"Send HTTP/2 PING frames to keep connections alive.","user":{"login":"mhils","id":1019198,"node_id":"MDQ6VXNlcjEwMTkxOTg=","avatar_url":"https://avatars.githubusercontent.com/u/1019198?v=4","gravatar_id":"","url":"https://api.github.com/users/mhils","html_url":"https://github.com/mhils","followers_url":"https://api.github.com/users/mhils/followers","following_url":"https://api.github.com/users/mhils/following{/other_user}","gists_url":"https://api.github.com/users/mhils/gists{/gist_id}","starred_url":"https://api.github.com/users/mhils/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhils/subscriptions","organizations_url":"https://api.github.com/users/mhils/orgs","repos_url":"https://api.github.com/users/mhils/repos","events_url":"https://api.github.com/users/mhils/events{/privacy}","received_events_url":"https://api.github.com/users/mhils/received_events","type":"User","site_admin":false},"labels":[{"id":79336545,"node_id":"MDU6TGFiZWw3OTMzNjU0NQ==","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/kind/feature","name":"kind/feature","color":"207de5","default":false,"description":"New features / enhancements"},{"id":429896009,"node_id":"MDU6TGFiZWw0Mjk4OTYwMDk=","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/area/protocols","name":"area/protocols","color":"fef2c0","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-01-11T07:48:20Z","updated_at":"2022-01-11T07:48:20Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"### Discussed in https://github.com/mitmproxy/mitmproxy/discussions/5044\r\n\r\n<div type='discussions-op-text'>\r\n\r\n<sup>Originally posted by **EndUser509** January 10, 2022</sup>\r\nI have noticed that for instance https://heise.de, when proxied, returns a '502' HTTP error to the client when I click on a link after not doing anything (=reading the page) for over 60 seconds. What I see on the outgoing interface is that the remote server resets the connection the moment the connection is used again (TCP RST). \r\nWhen not proxied I observe that the client sends a HTTP/2 PING after 60 seconds which seems to keep the connection alive. Varying the idle time from 60 to 120 seconds, I never manage to reset the connection and a link always loads. \r\nI wonder if there is a way to remedy the proxied behavior. I am not familiar enough with HTTP/2 to see if this PING interval is something that client and server agree to. Or if this is 'best practice' for browsers. Any ideas where to start? Would it make sense that the proxy sends regular PINGs for idle HTTP/2 connections? </div>","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5046/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5046/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5029","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5029/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5029/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5029/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/5029","id":1091520736,"node_id":"I_kwDOAAfumM5BD0jg","number":5029,"title":"Feature: fail to start if scripts do not load","user":{"login":"hazcod","id":5222512,"node_id":"MDQ6VXNlcjUyMjI1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/5222512?v=4","gravatar_id":"","url":"https://api.github.com/users/hazcod","html_url":"https://github.com/hazcod","followers_url":"https://api.github.com/users/hazcod/followers","following_url":"https://api.github.com/users/hazcod/following{/other_user}","gists_url":"https://api.github.com/users/hazcod/gists{/gist_id}","starred_url":"https://api.github.com/users/hazcod/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hazcod/subscriptions","organizations_url":"https://api.github.com/users/hazcod/orgs","repos_url":"https://api.github.com/users/hazcod/repos","events_url":"https://api.github.com/users/hazcod/events{/privacy}","received_events_url":"https://api.github.com/users/hazcod/received_events","type":"User","site_admin":false},"labels":[{"id":79336545,"node_id":"MDU6TGFiZWw3OTMzNjU0NQ==","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/kind/feature","name":"kind/feature","color":"207de5","default":false,"description":"New features / enhancements"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2021-12-31T10:44:02Z","updated_at":"2021-12-31T10:44:02Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"#### Problem Description\r\n\r\nSuppose we supply critical scripts to a mitmproxy instance which handle e.g. authentication, we can come into dangerous situations when the scripts fail to load (e.g. due to a syntax error) but since mitmproxy still proceeds with loading, the script is simply disabled, as can be seen here:\r\n\r\n```\r\nLoading script /plugins/foo\r\nin script /plugins/foo:574 invalid syntax (foo.py, line 100)\r\nProxy server listening at http://*:8080\r\n```\r\n\r\n#### Proposal\r\nExit mitmproxy with exit code 1 if a script fails to load.\r\n","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5029/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5029/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5019","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5019/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5019/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5019/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/5019","id":1088958508,"node_id":"I_kwDOAAfumM5A6DAs","number":5019,"title":"A hook for certificate verification overrides","user":{"login":"vthriller","id":176062,"node_id":"MDQ6VXNlcjE3NjA2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/176062?v=4","gravatar_id":"","url":"https://api.github.com/users/vthriller","html_url":"https://github.com/vthriller","followers_url":"https://api.github.com/users/vthriller/followers","following_url":"https://api.github.com/users/vthriller/following{/other_user}","gists_url":"https://api.github.com/users/vthriller/gists{/gist_id}","starred_url":"https://api.github.com/users/vthriller/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vthriller/subscriptions","organizations_url":"https://api.github.com/users/vthriller/orgs","repos_url":"https://api.github.com/users/vthriller/repos","events_url":"https://api.github.com/users/vthriller/events{/privacy}","received_events_url":"https://api.github.com/users/vthriller/received_events","type":"User","site_admin":false},"labels":[{"id":79336545,"node_id":"MDU6TGFiZWw3OTMzNjU0NQ==","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/kind/feature","name":"kind/feature","color":"207de5","default":false,"description":"New features / enhancements"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":13,"created_at":"2021-12-27T04:35:31Z","updated_at":"2022-01-11T08:01:55Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"#### Problem Description\r\n\r\nIt seems there is currently no way to tell mitmproxy to accept individual invalid server certificates¹, `--ssl-insecure`/`--no-ssl-insecure` is as granular as it currently gets. This is a problem for people that use mitmproxy for casual browsing and occasionally stumble upon some *non-critical* websites (like, say, blogs) with annoyances like slightly outdated certs.\r\n\r\n¹ Or maybe even discard valid ones? I'm not sure if anyone would find such feature useful though, so I'll speak about verification overrides for the rest of this post.\r\n\r\n#### Proposal\r\n\r\nA hook that will let addons choose `Verify.VERIFY_NONE` or `Verify.VERIFY_PEER` for each individual certificate and/or host.\r\n\r\n#### Alternatives\r\n\r\n- Extend the `ssl_insecure` option so that it could also accept a list of filters of some sort.\r\n  - This will definitely look like a mess if exposed via cmdline.\r\n- Alternatively `ssl_insecure` could accept path to file with a list of overrides.\r\n  - It seems it would make addons that implement \"accept the risk\" page or web-UI for overrides mgmt, well, a lot more hacky.\r\n  - As a bonus, however, this may allow users to reuse overrides stored in their Firefox profiles (`cert_override.txt`). (Can't say anything about WebKit/Blink-based browsers though.)\r\n\r\n#### Additional context\r\n\r\n[Gecko's `nsCertOverrideService.cpp`](https://github.com/mozilla/gecko-dev/blob/fce6eb7d8380f3e98429d1f5096d3a0dd0f412d2/security/manager/ssl/nsCertOverrideService.cpp) describes override matching process, as well as format of `cert_override.txt`, which basically boils down to: `host:port`, SHA-256 fingerprint, error kinds (any combination of `M`ismatch, `U`ntrusted, `T`ime), and DB key, which itself [is generated from serial and DN](https://github.com/mozilla/gecko-dev/blob/fce6eb7d8380f3e98429d1f5096d3a0dd0f412d2/security/manager/ssl/nsNSSCertificateDB.cpp#L94-L103).","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5019/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5019/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5014","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5014/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5014/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5014/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/5014","id":1088629601,"node_id":"I_kwDOAAfumM5A4yth","number":5014,"title":"Add IO stats graphs","user":{"login":"CodingSpiderFox","id":25173078,"node_id":"MDQ6VXNlcjI1MTczMDc4","avatar_url":"https://avatars.githubusercontent.com/u/25173078?v=4","gravatar_id":"","url":"https://api.github.com/users/CodingSpiderFox","html_url":"https://github.com/CodingSpiderFox","followers_url":"https://api.github.com/users/CodingSpiderFox/followers","following_url":"https://api.github.com/users/CodingSpiderFox/following{/other_user}","gists_url":"https://api.github.com/users/CodingSpiderFox/gists{/gist_id}","starred_url":"https://api.github.com/users/CodingSpiderFox/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodingSpiderFox/subscriptions","organizations_url":"https://api.github.com/users/CodingSpiderFox/orgs","repos_url":"https://api.github.com/users/CodingSpiderFox/repos","events_url":"https://api.github.com/users/CodingSpiderFox/events{/privacy}","received_events_url":"https://api.github.com/users/CodingSpiderFox/received_events","type":"User","site_admin":false},"labels":[{"id":79336545,"node_id":"MDU6TGFiZWw3OTMzNjU0NQ==","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/kind/feature","name":"kind/feature","color":"207de5","default":false,"description":"New features / enhancements"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2021-12-25T17:09:24Z","updated_at":"2021-12-25T19:55:34Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"#### Problem Description\r\n\r\nTo get a rough indication over the load that is handeled by mitmproxy, network IO, CPU and memory usage graphs on the command line UI would be helpful.\r\n\r\n#### Proposal\r\nCheck out how bpytop does it, it looks modern and is really useful :)\r\n\r\nPotentially interesting metrics:\r\nTop amount of requests by domain / IP\r\nTop amount of bytes transferred (in by domain or IP, out by domain/IP)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5014/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5014/timeline","performed_via_github_app":null},{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5013","repository_url":"https://api.github.com/repos/mitmproxy/mitmproxy","labels_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5013/labels{/name}","comments_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5013/comments","events_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5013/events","html_url":"https://github.com/mitmproxy/mitmproxy/issues/5013","id":1088610007,"node_id":"I_kwDOAAfumM5A4t7X","number":5013,"title":"Add command to display currently used version","user":{"login":"CodingSpiderFox","id":25173078,"node_id":"MDQ6VXNlcjI1MTczMDc4","avatar_url":"https://avatars.githubusercontent.com/u/25173078?v=4","gravatar_id":"","url":"https://api.github.com/users/CodingSpiderFox","html_url":"https://github.com/CodingSpiderFox","followers_url":"https://api.github.com/users/CodingSpiderFox/followers","following_url":"https://api.github.com/users/CodingSpiderFox/following{/other_user}","gists_url":"https://api.github.com/users/CodingSpiderFox/gists{/gist_id}","starred_url":"https://api.github.com/users/CodingSpiderFox/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CodingSpiderFox/subscriptions","organizations_url":"https://api.github.com/users/CodingSpiderFox/orgs","repos_url":"https://api.github.com/users/CodingSpiderFox/repos","events_url":"https://api.github.com/users/CodingSpiderFox/events{/privacy}","received_events_url":"https://api.github.com/users/CodingSpiderFox/received_events","type":"User","site_admin":false},"labels":[{"id":79336545,"node_id":"MDU6TGFiZWw3OTMzNjU0NQ==","url":"https://api.github.com/repos/mitmproxy/mitmproxy/labels/kind/feature","name":"kind/feature","color":"207de5","default":false,"description":"New features / enhancements"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2021-12-25T14:30:57Z","updated_at":"2021-12-25T14:43:16Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"#### Problem Description\r\n\r\nWhen testing multiple versions of mitmproxy I want to quickly be able to look up which version is running in my current terminal instance\r\n\r\n#### Proposal\r\nAdd a screen to the mitmproxy command line ui that displays version + git commit id of currently running version\r\n\r\n#### Alternatives\r\ncan't think of anything else\r\n\r\n","reactions":{"url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5013/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mitmproxy/mitmproxy/issues/5013/timeline","performed_via_github_app":null}]